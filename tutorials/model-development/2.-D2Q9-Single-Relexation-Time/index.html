



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="The reference manual for the TCLB solver">
      
      
      
        <meta name="author" content="T">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>D2Q9 Single Relexation Time (SRT)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.78aab2dc.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#the-srt-lattice-boltzmann-equation" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="TCLB Reference Manual" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                TCLB Reference Manual
              </span>
              <span class="md-header-nav__topic">
                D2Q9 Single Relexation Time (SRT)
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/CFD-GO/TCLB" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CFD-GO/TCLB
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    TCLB Reference Manual
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/CFD-GO/TCLB" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CFD-GO/TCLB
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Welcome to TCLB" class="md-nav__link">
      Welcome to TCLB
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      1. Getting started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        1. Getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../1.-Getting-started/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../1.-Getting-started/running-simulation/" title="Running calculations" class="md-nav__link">
      Running calculations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      2. Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        2. Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../2.-Installation/ESYS-Particle/" title="ESYS-Particle" class="md-nav__link">
      ESYS-Particle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../2.-Installation/configuration-options/" title="Configuration options" class="md-nav__link">
      Configuration options
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../2.-Installation/dependencies/" title="Dependencies" class="md-nav__link">
      Dependencies
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      3. Running simulations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        3. Running simulations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../3.-Running-simulations/case-basics/" title="Case Basics" class="md-nav__link">
      Case Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../3.-Running-simulations/examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../3.-Running-simulations/units/" title="Units" class="md-nav__link">
      Units
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../3.-Running-simulations/working-remotely/" title="Working on a remote host" class="md-nav__link">
      Working on a remote host
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      4. Post processing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        4. Post processing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../4.-Post-processing/catalyst/" title="Catalyst" class="md-nav__link">
      Catalyst
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../4.-Post-processing/paraview/" title="Analyzing Results with ParaView" class="md-nav__link">
      Analyzing Results with ParaView
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../4.-Post-processing/particles/" title="Post-processing of particle data" class="md-nav__link">
      Post-processing of particle data
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      5. Model development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        5. Model development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../5.-Model-development/basics/" title="Model Information" class="md-nav__link">
      Model Information
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../5.-Model-development/tips/" title="Pro Tips" class="md-nav__link">
      Pro Tips
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      XML Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        XML Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Callbacks/" title="Callbacks" class="md-nav__link">
      Callbacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Container/" title="Container" class="md-nav__link">
      Container
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Executions/" title="Executions" class="md-nav__link">
      Executions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Geometry-Boolean-Operation/" title="Geometry Boolean Operation" class="md-nav__link">
      Geometry Boolean Operation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Geometry-Primitive/" title="Geometry Primitive" class="md-nav__link">
      Geometry Primitive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Node-Type-Brush/" title="Node Type Brush" class="md-nav__link">
      Node Type Brush
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Optimization-and-Optimal-Control/" title="Optimization and Optimal Control" class="md-nav__link">
      Optimization and Optimal Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Params/" title="Params" class="md-nav__link">
      Params
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Setup-Elements/" title="Setup Elements" class="md-nav__link">
      Setup Elements
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      PDE
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        PDE
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/PDE/wave/" title="Wave" class="md-nav__link">
      Wave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/PDE/wave2d/" title="Wave2d" class="md-nav__link">
      Wave2d
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Article
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        Article
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/article/d3q19_heat_adj_art/" title="D3q19 heat adj art" class="md-nav__link">
      D3q19 heat adj art
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      Electrokinetic
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        Electrokinetic
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/electrokinetic/d2q9_npe_guo/" title="D2q9 npe guo" class="md-nav__link">
      D2q9 npe guo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/electrokinetic/d2q9_poison_boltzmann/" title="D2q9 poison boltzmann" class="md-nav__link">
      D2q9 poison boltzmann
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-4" type="checkbox" id="nav-8-4">
    
    <label class="md-nav__link" for="nav-8-4">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-4">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/experimental/d2q9_diff/" title="D2q9 diff" class="md-nav__link">
      D2q9 diff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/experimental/d2q9_hb/" title="D2q9 hb" class="md-nav__link">
      D2q9 hb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/experimental/d2q9_inc/" title="D2q9 inc" class="md-nav__link">
      D2q9 inc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5" type="checkbox" id="nav-8-5">
    
    <label class="md-nav__link" for="nav-8-5">
      Flow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-5">
        Flow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9_SRT/" title="d2q9 SRT" class="md-nav__link">
      d2q9 SRT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9_cumulant/" title="D2q9 cumulant" class="md-nav__link">
      D2q9 cumulant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9_les/" title="D2q9 les" class="md-nav__link">
      D2q9 les
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9_thin_film/" title="D2q9 thin film" class="md-nav__link">
      D2q9 thin film
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q19/" title="D3q19" class="md-nav__link">
      D3q19
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q19_les/" title="D3q19 les" class="md-nav__link">
      D3q19 les
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27/" title="D3q27" class="md-nav__link">
      D3q27
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5-8" type="checkbox" id="nav-8-5-8">
    
    <label class="md-nav__link" for="nav-8-5-8">
      D2q9
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-5-8">
        D2q9
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9/d2q9/" title="D2q9" class="md-nav__link">
      D2q9
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9/d2q9_BC/" title="d2q9 BC" class="md-nav__link">
      d2q9 BC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5-9" type="checkbox" id="nav-8-5-9">
    
    <label class="md-nav__link" for="nav-8-5-9">
      D3q27 cumulant
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-5-9">
        D3q27 cumulant
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant/" title="D3q27 cumulant" class="md-nav__link">
      D3q27 cumulant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_AVG/" title="d3q27 cumulant AVG" class="md-nav__link">
      d3q27 cumulant AVG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_AVG_IB/" title="d3q27 cumulant AVG IB" class="md-nav__link">
      d3q27 cumulant AVG IB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_AVG_IB_SMAG/" title="d3q27 cumulant AVG IB SMAG" class="md-nav__link">
      d3q27 cumulant AVG IB SMAG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_AVG_SMAG/" title="d3q27 cumulant AVG SMAG" class="md-nav__link">
      d3q27 cumulant AVG SMAG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_IB/" title="d3q27 cumulant IB" class="md-nav__link">
      d3q27 cumulant IB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_IB_SMAG/" title="d3q27 cumulant IB SMAG" class="md-nav__link">
      d3q27 cumulant IB SMAG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_SMAG/" title="d3q27 cumulant SMAG" class="md-nav__link">
      d3q27 cumulant SMAG
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5-10" type="checkbox" id="nav-8-5-10">
    
    <label class="md-nav__link" for="nav-8-5-10">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-5-10">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/experimental/d3q27_BGK/" title="d3q27 BGK" class="md-nav__link">
      d3q27 BGK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/experimental/d3q27_BGK_galcor/" title="d3q27 BGK galcor" class="md-nav__link">
      d3q27 BGK galcor
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5-11" type="checkbox" id="nav-8-5-11">
    
    <label class="md-nav__link" for="nav-8-5-11">
      Qibb
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-5-11">
        Qibb
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/qibb/d3q27_cumulant_qibb_small/" title="D3q27 cumulant qibb small" class="md-nav__link">
      D3q27 cumulant qibb small
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-6" type="checkbox" id="nav-8-6">
    
    <label class="md-nav__link" for="nav-8-6">
      Heat
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-6">
        Heat
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/heat/d3q19_heat/" title="D3q19 heat" class="md-nav__link">
      D3q19 heat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-6-2" type="checkbox" id="nav-8-6-2">
    
    <label class="md-nav__link" for="nav-8-6-2">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-6-2">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/heat/experimental/d2q9_heat/" title="D2q9 heat" class="md-nav__link">
      D2q9 heat
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-7" type="checkbox" id="nav-8-7">
    
    <label class="md-nav__link" for="nav-8-7">
      Moving
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-7">
        Moving
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/moving/d2q9_plate/" title="D2q9 plate" class="md-nav__link">
      D2q9 plate
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8" type="checkbox" id="nav-8-8">
    
    <label class="md-nav__link" for="nav-8-8">
      Multiphase
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-8">
        Multiphase
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_csf/" title="D2q9 csf" class="md-nav__link">
      D2q9 csf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_kuper/" title="D2q9 kuper" class="md-nav__link">
      D2q9 kuper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf/" title="D2q9 pf" class="md-nav__link">
      D2q9 pf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf_pressureEvolution/" title="d2q9 pf pressureEvolution" class="md-nav__link">
      d2q9 pf pressureEvolution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d3q19_kuper/" title="D3q19 kuper" class="md-nav__link">
      D3q19 kuper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-6" type="checkbox" id="nav-8-8-6">
    
    <label class="md-nav__link" for="nav-8-8-6">
      D2q9 pf velocity
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-6">
        D2q9 pf velocity
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf_velocity/d2q9_pf_velocity/" title="D2q9 pf velocity" class="md-nav__link">
      D2q9 pf velocity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf_velocity/d2q9_pf_velocity_GF/" title="d2q9 pf velocity GF" class="md-nav__link">
      d2q9 pf velocity GF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf_velocity/d2q9_pf_velocity_RT/" title="d2q9 pf velocity RT" class="md-nav__link">
      d2q9 pf velocity RT
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-7" type="checkbox" id="nav-8-8-7">
    
    <label class="md-nav__link" for="nav-8-8-7">
      D3q27 pf velocity
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-7">
        D3q27 pf velocity
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d3q27_pf_velocity/d3q27_pf_velocity/" title="D3q27 pf velocity" class="md-nav__link">
      D3q27 pf velocity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d3q27_pf_velocity/d3q27_pf_velocity_SC/" title="d3q27 pf velocity SC" class="md-nav__link">
      d3q27 pf velocity SC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-8" type="checkbox" id="nav-8-8-8">
    
    <label class="md-nav__link" for="nav-8-8-8">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-8">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/experimental/d2q9_lee/" title="D2q9 lee" class="md-nav__link">
      D2q9 lee
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/experimental/d2q9_pp_LBL/" title="d2q9 pp LBL" class="md-nav__link">
      d2q9 pp LBL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/experimental/d2q9_pp_MCMP/" title="d2q9 pp MCMP" class="md-nav__link">
      d2q9 pp MCMP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-9" type="checkbox" id="nav-8-8-9">
    
    <label class="md-nav__link" for="nav-8-8-9">
      Solidification
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-9">
        Solidification
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/solidification/d2q9_solid/" title="D2q9 solid" class="md-nav__link">
      D2q9 solid
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-9" type="checkbox" id="nav-8-9">
    
    <label class="md-nav__link" for="nav-8-9">
      Nonnewtonian
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-9">
        Nonnewtonian
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/nonnewtonian/d3q27_viscoplastic/" title="D3q27 viscoplastic" class="md-nav__link">
      D3q27 viscoplastic
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-10" type="checkbox" id="nav-8-10">
    
    <label class="md-nav__link" for="nav-8-10">
      Optimization
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-10">
        Optimization
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/optimization/d2q9_adj/" title="D2q9 adj" class="md-nav__link">
      D2q9 adj
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/optimization/d2q9_optimalMixing/" title="d2q9 optimalMixing" class="md-nav__link">
      d2q9 optimalMixing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/optimization/d3q19_heat_adj/" title="D3q19 heat adj" class="md-nav__link">
      D3q19 heat adj
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-10-4" type="checkbox" id="nav-8-10-4">
    
    <label class="md-nav__link" for="nav-8-10-4">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-10-4">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/optimization/experimental/d2q9_heat_adj/" title="D2q9 heat adj" class="md-nav__link">
      D2q9 heat adj
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-11" type="checkbox" id="nav-8-11">
    
    <label class="md-nav__link" for="nav-8-11">
      Shallowwater
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-11">
        Shallowwater
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/shallowwater/sw/" title="Sw" class="md-nav__link">
      Sw
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-1" type="checkbox" id="nav-9-1" checked>
    
    <label class="md-nav__link" for="nav-9-1">
      Model development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-1">
        Model development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../1.-finite-difference-wave-equation/" title="Finite difference wave equation" class="md-nav__link">
      Finite difference wave equation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        D2Q9 Single Relexation Time (SRT)
      </label>
    
    <a href="./" title="D2Q9 Single Relexation Time (SRT)" class="md-nav__link md-nav__link--active">
      D2Q9 Single Relexation Time (SRT)
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-srt-lattice-boltzmann-equation" title="The SRT-lattice Boltzmann Equation" class="md-nav__link">
    The SRT-lattice Boltzmann Equation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boundary-conditions-and-force-implementation" title="Boundary Conditions and Force Implementation" class="md-nav__link">
    Boundary Conditions and Force Implementation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-creation-in-tclb" title="Model Creation in TCLB" class="md-nav__link">
    Model Creation in TCLB
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-a-simulation" title="Setting up a Simulation" class="md-nav__link">
    Setting up a Simulation
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3.-D2Q9-ShanChen-SRT/" title="3. D2Q9 ShanChen SRT" class="md-nav__link">
      3. D2Q9 ShanChen SRT
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">
    
    <label class="md-nav__link" for="nav-9-2">
      Particles
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-2">
        Particles
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../particles/particles-in-pipe/" title="Particles in pipe" class="md-nav__link">
      Particles in pipe
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-srt-lattice-boltzmann-equation" title="The SRT-lattice Boltzmann Equation" class="md-nav__link">
    The SRT-lattice Boltzmann Equation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boundary-conditions-and-force-implementation" title="Boundary Conditions and Force Implementation" class="md-nav__link">
    Boundary Conditions and Force Implementation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-creation-in-tclb" title="Model Creation in TCLB" class="md-nav__link">
    Model Creation in TCLB
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-a-simulation" title="Setting up a Simulation" class="md-nav__link">
    Setting up a Simulation
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>D2Q9 Single Relexation Time (SRT)</h1>
                
                <p>This tutorial will try to teach you how to make and use lattice Boltzmann (LB) models within the TCLB environment. First a brief overview will be given of the discrete <a href="https://en.wikipedia.org/wiki/Lattice_Boltzmann_methods">lattice Boltzmann equation</a> taking advantage of the Bhatnagar-Gross-Krook (BGK) collision operator (also known as single relaxation time operator) will be given, then the code required to simulate Poiseuille flow will be developed.</p>
<h2 id="the-srt-lattice-boltzmann-equation">The SRT-lattice Boltzmann Equation</h2>
<p>The discrete form of the Boltzmann transport equation can be expressed as:</p>
<p>
<script type="math/tex; mode=display"> f_i(x+c_i,t+1)=f_i(x,t)-\frac{1}{\tau}(f_i(x,t)-f_i^{eq}(x,t)) </script>
</p>
<p>This describes the evolution of particle distribution functions along discrete velocities, where the right hand side is often referred to as the collision operation and the evaluation to the left hand side, the streaming operation. Note here that we are going to work in lattice units during the description of the model in which we assume $\Delta x = \Delta t = 1$. For the D2Q9 model, this assumption allows us to express the 9 discrete directions as,</p>
<p>
<script type="math/tex; mode=display"> c = \left( \begin{array}& 0 & 1 & 0 & -1 & 0 & 1 & -1 & -1 & 1 \\ 0 & 0 & 1 & 0 & -1 & 1 & 1 & -1 & -1 \end{array} \right) </script>
</p>
<p>Additionally, we define the equilibrium distribution function found by an expansion of a Maxwellian distribution as,</p>
<p>
<script type="math/tex; mode=display"> f_i^{eq}(x,t) = \omega _ i \rho \left( 1 + \frac{c_iu}{c_s^2}+ \frac{(c_iu)^2}{2c_s^4} - \frac{u^2}{2c_s^2} \right) </script>
</p>
<p>where,</p>
<p>
<script type="math/tex; mode=display"> c_s^2 = \frac{1}{3} </script>
</p>
<p>
<script type="math/tex; mode=display"> \omega_i=\left\{ \begin{array}{ll}  \frac{4}{9}  & i=0\\ \frac{1}{9} & i=1,2,3,4\\ \frac{1}{36} & i=5,6,7,8 \end{array} \right. </script>
</p>
<h3 id="boundary-conditions-and-force-implementation">Boundary Conditions and Force Implementation</h3>
<p>For this specific example, we are looking at a flow through a channel. We can utilise periodic conditions along the x-axis but have to implement no-slip wall conditions to limit  domain along y-axis. To do this with LBM, the bounceback method is used.  Particle distribution functions that stream into a node flagged as a "wall" are reversed, or "bounced-back" in the opposite direction Therefore, in general for a D2Q9 lattice we obtain,</p>
<p>
<script type="math/tex; mode=display"> \left\{ \begin{array}{ll}   f_0=f'_0\\ f_1=f'_3\\ f_2=f'_4\\ f_3=f'_1\\ f_4=f'_2\\ f_5=f'_7\\ f_6=f'_8\\ f_7=f'_5\\ f_8=f'_6\\  \end{array} \right. </script>
</p>
<p>where ' indicates the post-bounce-back direction.</p>
<p>To drive the fluid in the Poiseuille flow example, a body force will be applied. For this we consider a body force <strong>G</strong> acting in each time increment resulting in a momentum change $\Delta\rho u = G$ . To incorporate this, we modify the equilibrium velocity,</p>
<p>
<script type="math/tex; mode=display">\rho u^* = \rho u + \tau G </script>
</p>
<p>This approach ultimately acts to relax each particle distribution function towards an equilibrium momentum that has included the time-incremental change due to the applied body force. To obtain the bulk fluid velocity, the before and after collision momentum is averaged giving,</p>
<p>
<script type="math/tex; mode=display"> \rho v = \rho u + \frac{1}{2} G </script>
</p>
<p>and with this we now have all we the dynamics required to implement the specified example.</p>
<h2 id="model-creation-in-tclb">Model Creation in TCLB</h2>
<p>As in the previous <a href="TODO:podlinkować fdwave">tutorial</a>, we want to set up a folder named <code>d2q9srt</code> in  <code>~TCLB/models/tutorial/</code> and create the generic file structure (<code>conf.mk</code>, <code>Dynamics.c</code>, <code>Dynamics.R</code>).</p>
<p>To start off the model, we look to add the nine distribution functions for the nine discrete velocities. This is implemented in the <code>Dynamics.R</code> file, but instead of adding each as its own field we look to stream the functions in the process of calling them at each node. To do this we instead add them as <a href="TODO:podlinkować">Densities</a>:</p>
<div class="codehilite"><pre><span></span>AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[0]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">0</span><span class="p">,</span> dy<span class="o">=</span><span class="m">0</span>  <span class="p">)</span>
AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[1]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">1</span><span class="p">,</span> dy<span class="o">=</span><span class="m">0</span>  <span class="p">)</span>
AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[2]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">0</span><span class="p">,</span> dy<span class="o">=</span><span class="m">1</span>  <span class="p">)</span>
AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[3]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">-1</span><span class="p">,</span>dy<span class="o">=</span><span class="m">0</span>  <span class="p">)</span>
AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[4]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">0</span><span class="p">,</span> dy<span class="o">=</span><span class="m">-1</span> <span class="p">)</span>
AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[5]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">1</span><span class="p">,</span> dy<span class="o">=</span><span class="m">1</span>  <span class="p">)</span>
AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[6]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">-1</span><span class="p">,</span>dy<span class="o">=</span><span class="m">1</span>  <span class="p">)</span>
AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[7]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">-1</span><span class="p">,</span>dy<span class="o">=</span><span class="m">-1</span> <span class="p">)</span>
AddDensity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;f[8]&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="m">1</span><span class="p">,</span> dy<span class="o">=</span><span class="m">-1</span> <span class="p">)</span>
</pre></div>


<p>Notice that the dx and dy coordinates correspond with the <strong>c</strong> matrix previously given. At this stage, it helps to assess what other values will be  needed to initialise and run the LBM. To start off the method, a fluid density and initial velocities must be specified, then to perform the collision operation the relaxation time  and the magnitude of the applied body force need to be defined . Additionally, from this simulation we want to be able to interrogate the macroscopic fluid velocity and density so these must be added as <a href="TODO:link">Quantities</a>.  For this, we define (in <code>Dynamics.R</code>):</p>
<div class="codehilite"><pre><span></span>AddQuantity<span class="p">(</span> name<span class="o">=</span><span class="s">&quot;U&quot;</span><span class="p">,</span>unit<span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">,</span> <span class="kt">vector</span><span class="o">=</span><span class="kc">TRUE</span> <span class="p">)</span>
AddQuantity<span class="p">(</span> name<span class="o">=</span><span class="s">&quot;Rho&quot;</span><span class="p">,</span>unit<span class="o">=</span><span class="s">&quot;kg/m3&quot;</span> <span class="p">)</span>

AddSetting<span class="p">(</span> name<span class="o">=</span><span class="s">&quot;omega&quot;</span><span class="p">,</span> comment<span class="o">=</span><span class="s">&#39;inverse of relaxation time&#39;</span><span class="p">)</span>
AddSetting<span class="p">(</span> name<span class="o">=</span><span class="s">&quot;nu&quot;</span><span class="p">,</span> omega<span class="o">=</span><span class="s">&#39;1.0/(3*nu+0.5)&#39;</span><span class="p">,</span> default<span class="o">=</span><span class="m">0.16666666</span><span class="p">,</span> comment<span class="o">=</span><span class="s">&#39;viscosity&#39;</span><span class="p">)</span>
AddSetting<span class="p">(</span> name<span class="o">=</span><span class="s">&quot;Velocity&quot;</span><span class="p">,</span>default<span class="o">=</span><span class="m">0</span><span class="p">,</span> comment<span class="o">=</span><span class="s">&#39;inlet/outlet/init velocity&#39;</span><span class="p">,</span> zonal<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
AddSetting<span class="p">(</span> name<span class="o">=</span><span class="s">&quot;GravitationX&quot;</span><span class="p">,</span>default<span class="o">=</span><span class="m">0</span><span class="p">,</span> comment<span class="o">=</span><span class="s">&#39;body/external acceleration&#39;</span><span class="p">,</span> zonal<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
AddSetting<span class="p">(</span> name<span class="o">=</span><span class="s">&quot;GravitationY&quot;</span><span class="p">,</span>default<span class="o">=</span><span class="m">0</span><span class="p">,</span> comment<span class="o">=</span><span class="s">&#39;body/external acceleration&#39;</span><span class="p">,</span> zonal<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
AddSetting<span class="p">(</span> name<span class="o">=</span><span class="s">&quot;Density&quot;</span><span class="p">,</span>default<span class="o">=</span><span class="m">1</span><span class="p">,</span> comment<span class="o">=</span><span class="s">&#39;Density&#39;</span><span class="p">)</span>
</pre></div>


<p>From the above, we have all the variables we need to implement the LBM. The first step is to initialise the lattice over the required domain, this is incorporated as part of the dynamics that are occurring in the model and must be incorporated into the <code>Dynamics.c</code> file within the <code>Init()</code> function.</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Init</span><span class="p">(){</span>
    <span class="n">real_t</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">Velocity</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">};</span>
    <span class="n">real_t</span> <span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">;</span>
    <span class="n">SetEquilibrium</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>Notice here that we are calling on the function <code>SetEquilibrium()</code> within which we want to calculate the equilibrium distribution $f_i^{eq}$ for the given density and velocity fields.</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">SetEquilibrium</span><span class="p">(</span><span class="n">real_t</span> <span class="n">d</span><span class="p">,</span> <span class="n">real_t</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="p">{</span>
<span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="mf">2.</span><span class="o">/</span><span class="mf">9.</span><span class="p">;</span>
<span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">2.</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">18.</span><span class="p">;</span>
<span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">2.</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">18.</span><span class="p">;</span>
<span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">2.</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">18.</span><span class="p">;</span>
<span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">2.</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">2.</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">18.</span><span class="p">;</span>
<span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">36.</span><span class="p">;</span>
<span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">36.</span><span class="p">;</span>
<span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span> <span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">36.</span><span class="p">;</span>
<span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span> <span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="mf">3.</span> <span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">36.</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>With the equilibrium function taken care of, we can now look at updating our initialised lattice. For this, the streaming operation is taken care of with the specification of <a href="TODO:podlinkować">Densities</a> that we made. The collision operation however needs to be implemented and bounce-back for nodes flagged as walls. To do this, we define the <code>run()</code> function to describe what happens at each node at each timestep.</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Run</span><span class="p">()</span> <span class="p">{</span>
<span class="c1">// This defines the dynamics that we run at each node in the domain.</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">NodeType</span> <span class="o">&amp;</span> <span class="n">NODE_BOUNDARY</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nl">NODE_Wall</span><span class="p">:</span>
        <span class="n">BounceBack</span><span class="p">();</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">NodeType</span> <span class="o">&amp;</span> <span class="n">NODE_BOUNDARY</span><span class="p">)</span> <span class="o">==</span> <span class="n">NODE_BGK</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">CollisionBGK</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p><strong>Don't forget to declare new node types in <code>Dynamics.R</code>.</strong></p>
<p>Additionally, in all <code>Dynamics.c</code> files the <code>Color()</code> function is required. (even with <code>./configure --disable-graphics</code>).</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="n">float2</span> <span class="nf">Color</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">float2</span> <span class="n">ret</span><span class="p">;</span>
  <span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">ret</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>The switch function described can also be used for the implementation of velocity/pressure boundaries, but these will not be discussed in this tutorial. As can be seen above, we need to define functions that describe both the <code>BounceBack()</code> and <code>CollisionBGK()</code> operations. The bounce-back operation occurs as described in the theory component of this tutorial where distribution functions are reversed:</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">BounceBack</span><span class="p">()</span> <span class="p">{</span>
<span class="c1">// Method to reverse distribution functions along the bounding nodes.</span>
        <span class="n">real_t</span> <span class="n">uf</span><span class="p">;</span>
    <span class="n">uf</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">uf</span><span class="p">;</span>
    <span class="n">uf</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">uf</span><span class="p">;</span>
    <span class="n">uf</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">uf</span><span class="p">;</span>
    <span class="n">uf</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">uf</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>The BGK collision, from the left hand side of the discrete Boltzmann equation:</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">CollisionBGK</span><span class="p">()</span> <span class="p">{</span>
<span class="c1">// Here we perform a single relaxation time collision operation.</span>
<span class="c1">// We save memory here by using a single dummy variable</span>
    <span class="n">real_t</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">d</span><span class="p">,</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">getRho</span><span class="p">();</span>
    <span class="c1">// pu* = pu + rG</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span><span class="n">d</span> <span class="o">+</span> <span class="n">GravitationX</span><span class="o">/</span><span class="n">omega</span> <span class="p">);</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span><span class="n">d</span> <span class="o">+</span> <span class="n">GravitationY</span><span class="o">/</span><span class="n">omega</span> <span class="p">);</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
    <span class="n">f_temp</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
    <span class="n">SetEquilibrium</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span> <span class="c1">//stores equilibrium distribution in f[0]-f[8]</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>  
    <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>  
    <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>  
    <span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]);</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_temp</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">f_temp</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>


<p>With all the dynamics described, all that is left to do now is calculate the macroscopic variables using <code>Get</code> functions to correspond with the Quantities stated in <code>Dynamics.R</code>.The macroscopic density is the sum of all the distribution functions and the momentum is the sum of the distribution functions multiplied by the discrete velocity directions.</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="n">real_t</span> <span class="nf">getRho</span><span class="p">()</span> <span class="p">{</span>
<span class="c1">// This function defines the macroscopic density at the current node.</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">CudaDeviceFunction</span> <span class="n">vector_t</span> <span class="nf">getU</span><span class="p">()</span> <span class="p">{</span>
<span class="c1">// This function defines the macroscopic velocity at the current node.</span>
    <span class="n">real_t</span> <span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">vector_t</span> <span class="n">u</span><span class="p">;</span>
    <span class="c1">// pv = pu + G/2</span>
    <span class="n">u</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">((</span> <span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span><span class="n">d</span> <span class="o">+</span> <span class="n">GravitationX</span><span class="o">*</span><span class="mf">0.5</span> <span class="p">);</span>
    <span class="n">u</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span><span class="n">d</span> <span class="o">+</span> <span class="n">GravitationY</span><span class="o">*</span><span class="mf">0.5</span> <span class="p">);</span>
    <span class="n">u</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<h2 id="setting-up-a-simulation">Setting up a Simulation</h2>
<p>In order validate this example, we want to specify the relation between physical and lattice units. For this, we need provide the relations for the spatial and time dimensions. The most natural way to do this is to give the physical <code>dx</code> size and the actual fluid viscosity. This information is stored at the start of the <code>xml</code> input file under the parent heading of <code>&lt;Units&gt;</code>, for this you want to first create a new file by the name of <code>d2q9_poiseuille.xml</code>:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;CLBConfig</span> <span class="na">version=</span><span class="s">&quot;2.0&quot;</span> <span class="na">output=</span><span class="s">&quot;output/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Units&gt;</span>
        <span class="nt">&lt;Params</span> <span class="na">size=</span><span class="s">&quot;0.0005m&quot;</span> <span class="na">gauge=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Params</span> <span class="na">nu=</span><span class="s">&quot;1e-5m2/s&quot;</span> <span class="na">gauge=</span><span class="s">&quot;0.1666666666&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/Units&gt;</span>
</pre></div>


<p>The reason for this, is it gives not only a view of how to implement physical values in TCLB but gives a straightforward method to calculate the expected maximum physical velocity. We do this through a comparison of the maximum velocity which in Poiseuille is given by:</p>
<p>
<script type="math/tex; mode=display"> u_{max} = \frac{gH^2}{8\nu} </script>
</p>
<p>The setup of the test simulation domain is arbitrary and different values can be tested from those shown here. A channel of <code>0.02m</code> length and <code>0.0095m</code> height is chosen with an applied body force of <code>0.000311634m/s^2</code>. As stated above one lattice spacing is equal to <code>0.0005m</code> so the total size of the simulation domain will be <code>0.02 x (0.0095+2*0.0005) m</code>. This is defined as the geometry of the system in the xml set up file noting that the in-built <code>&lt;Channel&gt;</code> function is used to specify the bottom and top nodes as walls:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Geometry</span> <span class="na">nx=</span><span class="s">&quot;0.02m&quot;</span> <span class="na">ny=</span><span class="s">&quot;0.0105m&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;BGK&gt;&lt;Box/&gt;&lt;/BGK&gt;</span>
    <span class="nt">&lt;Wall</span> <span class="na">mask=</span><span class="s">&quot;ALL&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Channel/&gt;</span>
    <span class="nt">&lt;/Wall&gt;</span>
<span class="nt">&lt;/Geometry&gt;</span>
</pre></div>


<p>Here we can see that the collision method specified for the cells in the entire domain is BGK to align with the <code>Run</code> function. Following on from the geometry of the domain, the model specific settings (defined in <code>Dynamics.R</code>) need to be defined. For this we take a fluid of density <code>1000kg/m^3</code> and choose a relaxation time of the value 1.</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Model&gt;</span>
    <span class="nt">&lt;Params</span> <span class="na">Velocity=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Params</span> <span class="na">omega=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Params</span> <span class="na">GravitationX=</span><span class="s">&quot;0.000311634m/s2&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Params</span> <span class="na">Density=</span><span class="s">&quot;1000kg/m3&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/Model&gt;</span>
</pre></div>


<p>The final step is to output the desired quantities both at the start (so we can be sure that we have initialised the lattice correctly) and after the final solution step.</p>
<div class="codehilite"><pre><span></span>    <span class="nt">&lt;VTK/&gt;</span>
    <span class="nt">&lt;VTK</span> <span class="na">Iterations=</span><span class="s">&quot;50000&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Solve</span> <span class="na">Iterations=</span><span class="s">&quot;50000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/CLBConfig&gt;</span>
</pre></div>


<p>With the model and set-up files created, we can now look to make and run d2q9srt. To do this first enter the TCLB directory and call the run file along with the input file location, after this, the analysis can be performed in Paraview:</p>
<div class="codehilite"><pre><span></span>make d2q9srt
CLB/d2q9srt/main d2q9_poiseuille.xml
paraview output/d2q9_poiseuille_VTK_P00_..pvti
</pre></div>


<p>In case the calculations are run on CPU, an mpi run can also be initiated e.g:</p>
<div class="codehilite"><pre><span></span>mpirun -np <span class="m">4</span> CLB/d2q9srt/main d2q9_poiseuille.xml
</pre></div>


<p>From the analytical equation given before, we expect a maximum velocity of <code>0.000351562m/s</code>, while in the results it is found to be <code>0.00035293m/s</code> showing an error of 0.389%.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../1.-finite-difference-wave-equation/" title="Finite difference wave equation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Finite difference wave equation
              </span>
            </div>
          </a>
        
        
          <a href="../3.-D2Q9-ShanChen-SRT/" title="3. D2Q9 ShanChen SRT" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                3. D2Q9 ShanChen SRT
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
    
      
    
  </body>
</html>