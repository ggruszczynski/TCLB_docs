



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="The reference manual for the TCLB solver">
      
      
      
        <meta name="author" content=""">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>Finite difference wave equation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.78aab2dc.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#finite-difference-wave-equation" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="TCLB Reference Manual" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                TCLB Reference Manual
              </span>
              <span class="md-header-nav__topic">
                Finite difference wave equation
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/CFD-GO/TCLB" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CFD-GO/TCLB
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    TCLB Reference Manual
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/CFD-GO/TCLB" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CFD-GO/TCLB
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Welcome to TCLB" class="md-nav__link">
      Welcome to TCLB
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      1. Getting started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        1. Getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../1.-Getting-started/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../1.-Getting-started/running-simulation/" title="Running calculations" class="md-nav__link">
      Running calculations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      2. Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        2. Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../2.-Installation/ESYS-Particle/" title="ESYS-Particle" class="md-nav__link">
      ESYS-Particle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../2.-Installation/configuration-options/" title="Configuration options" class="md-nav__link">
      Configuration options
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../2.-Installation/dependencies/" title="Dependencies" class="md-nav__link">
      Dependencies
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      3. Running simulations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        3. Running simulations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../3.-Running-simulations/case-basics/" title="Case Basics" class="md-nav__link">
      Case Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../3.-Running-simulations/examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../3.-Running-simulations/units/" title="Units" class="md-nav__link">
      Units
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../3.-Running-simulations/working-remotely/" title="Working on a remote host" class="md-nav__link">
      Working on a remote host
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      4. Post processing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        4. Post processing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../4.-Post-processing/catalyst/" title="Catalyst" class="md-nav__link">
      Catalyst
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../4.-Post-processing/paraview/" title="Analyzing Results with ParaView" class="md-nav__link">
      Analyzing Results with ParaView
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../4.-Post-processing/particles/" title="Post-processing of particle data" class="md-nav__link">
      Post-processing of particle data
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      5. Model development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        5. Model development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../5.-Model-development/basics/" title="Model Information" class="md-nav__link">
      Model Information
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../5.-Model-development/tips/" title="Pro Tips" class="md-nav__link">
      Pro Tips
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      XML Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        XML Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Callbacks/" title="Callbacks" class="md-nav__link">
      Callbacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Container/" title="Container" class="md-nav__link">
      Container
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Executions/" title="Executions" class="md-nav__link">
      Executions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Geometry-Boolean-Operation/" title="Geometry Boolean Operation" class="md-nav__link">
      Geometry Boolean Operation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Geometry-Primitive/" title="Geometry Primitive" class="md-nav__link">
      Geometry Primitive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Node-Type-Brush/" title="Node Type Brush" class="md-nav__link">
      Node Type Brush
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Optimization-and-Optimal-Control/" title="Optimization and Optimal Control" class="md-nav__link">
      Optimization and Optimal Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Params/" title="Params" class="md-nav__link">
      Params
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../XML-Reference/Setup-Elements/" title="Setup Elements" class="md-nav__link">
      Setup Elements
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      PDE
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        PDE
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/PDE/wave/" title="Wave" class="md-nav__link">
      Wave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/PDE/wave2d/" title="Wave2d" class="md-nav__link">
      Wave2d
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Article
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        Article
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/article/d3q19_heat_adj_art/" title="D3q19 heat adj art" class="md-nav__link">
      D3q19 heat adj art
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      Electrokinetic
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        Electrokinetic
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/electrokinetic/d2q9_npe_guo/" title="D2q9 npe guo" class="md-nav__link">
      D2q9 npe guo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/electrokinetic/d2q9_poison_boltzmann/" title="D2q9 poison boltzmann" class="md-nav__link">
      D2q9 poison boltzmann
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-4" type="checkbox" id="nav-8-4">
    
    <label class="md-nav__link" for="nav-8-4">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-4">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/experimental/d2q9_diff/" title="D2q9 diff" class="md-nav__link">
      D2q9 diff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/experimental/d2q9_hb/" title="D2q9 hb" class="md-nav__link">
      D2q9 hb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/experimental/d2q9_inc/" title="D2q9 inc" class="md-nav__link">
      D2q9 inc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5" type="checkbox" id="nav-8-5">
    
    <label class="md-nav__link" for="nav-8-5">
      Flow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-5">
        Flow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9_SRT/" title="d2q9 SRT" class="md-nav__link">
      d2q9 SRT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9_cumulant/" title="D2q9 cumulant" class="md-nav__link">
      D2q9 cumulant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9_les/" title="D2q9 les" class="md-nav__link">
      D2q9 les
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9_thin_film/" title="D2q9 thin film" class="md-nav__link">
      D2q9 thin film
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q19/" title="D3q19" class="md-nav__link">
      D3q19
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q19_les/" title="D3q19 les" class="md-nav__link">
      D3q19 les
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27/" title="D3q27" class="md-nav__link">
      D3q27
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5-8" type="checkbox" id="nav-8-5-8">
    
    <label class="md-nav__link" for="nav-8-5-8">
      D2q9
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-5-8">
        D2q9
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9/d2q9/" title="D2q9" class="md-nav__link">
      D2q9
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d2q9/d2q9_BC/" title="d2q9 BC" class="md-nav__link">
      d2q9 BC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5-9" type="checkbox" id="nav-8-5-9">
    
    <label class="md-nav__link" for="nav-8-5-9">
      D3q27 cumulant
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-5-9">
        D3q27 cumulant
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant/" title="D3q27 cumulant" class="md-nav__link">
      D3q27 cumulant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_AVG/" title="d3q27 cumulant AVG" class="md-nav__link">
      d3q27 cumulant AVG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_AVG_IB/" title="d3q27 cumulant AVG IB" class="md-nav__link">
      d3q27 cumulant AVG IB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_AVG_IB_SMAG/" title="d3q27 cumulant AVG IB SMAG" class="md-nav__link">
      d3q27 cumulant AVG IB SMAG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_AVG_SMAG/" title="d3q27 cumulant AVG SMAG" class="md-nav__link">
      d3q27 cumulant AVG SMAG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_IB/" title="d3q27 cumulant IB" class="md-nav__link">
      d3q27 cumulant IB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_IB_SMAG/" title="d3q27 cumulant IB SMAG" class="md-nav__link">
      d3q27 cumulant IB SMAG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/d3q27_cumulant/d3q27_cumulant_SMAG/" title="d3q27 cumulant SMAG" class="md-nav__link">
      d3q27 cumulant SMAG
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5-10" type="checkbox" id="nav-8-5-10">
    
    <label class="md-nav__link" for="nav-8-5-10">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-5-10">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/experimental/d3q27_BGK/" title="d3q27 BGK" class="md-nav__link">
      d3q27 BGK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/experimental/d3q27_BGK_galcor/" title="d3q27 BGK galcor" class="md-nav__link">
      d3q27 BGK galcor
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-5-11" type="checkbox" id="nav-8-5-11">
    
    <label class="md-nav__link" for="nav-8-5-11">
      Qibb
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-5-11">
        Qibb
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/flow/qibb/d3q27_cumulant_qibb_small/" title="D3q27 cumulant qibb small" class="md-nav__link">
      D3q27 cumulant qibb small
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-6" type="checkbox" id="nav-8-6">
    
    <label class="md-nav__link" for="nav-8-6">
      Heat
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-6">
        Heat
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/heat/d3q19_heat/" title="D3q19 heat" class="md-nav__link">
      D3q19 heat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-6-2" type="checkbox" id="nav-8-6-2">
    
    <label class="md-nav__link" for="nav-8-6-2">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-6-2">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/heat/experimental/d2q9_heat/" title="D2q9 heat" class="md-nav__link">
      D2q9 heat
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-7" type="checkbox" id="nav-8-7">
    
    <label class="md-nav__link" for="nav-8-7">
      Moving
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-7">
        Moving
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/moving/d2q9_plate/" title="D2q9 plate" class="md-nav__link">
      D2q9 plate
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8" type="checkbox" id="nav-8-8">
    
    <label class="md-nav__link" for="nav-8-8">
      Multiphase
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-8">
        Multiphase
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_csf/" title="D2q9 csf" class="md-nav__link">
      D2q9 csf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_kuper/" title="D2q9 kuper" class="md-nav__link">
      D2q9 kuper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf/" title="D2q9 pf" class="md-nav__link">
      D2q9 pf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf_pressureEvolution/" title="d2q9 pf pressureEvolution" class="md-nav__link">
      d2q9 pf pressureEvolution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d3q19_kuper/" title="D3q19 kuper" class="md-nav__link">
      D3q19 kuper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-6" type="checkbox" id="nav-8-8-6">
    
    <label class="md-nav__link" for="nav-8-8-6">
      D2q9 pf velocity
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-6">
        D2q9 pf velocity
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf_velocity/d2q9_pf_velocity/" title="D2q9 pf velocity" class="md-nav__link">
      D2q9 pf velocity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf_velocity/d2q9_pf_velocity_GF/" title="d2q9 pf velocity GF" class="md-nav__link">
      d2q9 pf velocity GF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d2q9_pf_velocity/d2q9_pf_velocity_RT/" title="d2q9 pf velocity RT" class="md-nav__link">
      d2q9 pf velocity RT
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-7" type="checkbox" id="nav-8-8-7">
    
    <label class="md-nav__link" for="nav-8-8-7">
      D3q27 pf velocity
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-7">
        D3q27 pf velocity
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d3q27_pf_velocity/d3q27_pf_velocity/" title="D3q27 pf velocity" class="md-nav__link">
      D3q27 pf velocity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/d3q27_pf_velocity/d3q27_pf_velocity_SC/" title="d3q27 pf velocity SC" class="md-nav__link">
      d3q27 pf velocity SC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-8" type="checkbox" id="nav-8-8-8">
    
    <label class="md-nav__link" for="nav-8-8-8">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-8">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/experimental/d2q9_lee/" title="D2q9 lee" class="md-nav__link">
      D2q9 lee
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/experimental/d2q9_pp_LBL/" title="d2q9 pp LBL" class="md-nav__link">
      d2q9 pp LBL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/experimental/d2q9_pp_MCMP/" title="d2q9 pp MCMP" class="md-nav__link">
      d2q9 pp MCMP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-9" type="checkbox" id="nav-8-8-9">
    
    <label class="md-nav__link" for="nav-8-8-9">
      Solidification
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-9">
        Solidification
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/multiphase/solidification/d2q9_solid/" title="D2q9 solid" class="md-nav__link">
      D2q9 solid
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-9" type="checkbox" id="nav-8-9">
    
    <label class="md-nav__link" for="nav-8-9">
      Nonnewtonian
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-9">
        Nonnewtonian
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/nonnewtonian/d3q27_viscoplastic/" title="D3q27 viscoplastic" class="md-nav__link">
      D3q27 viscoplastic
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-10" type="checkbox" id="nav-8-10">
    
    <label class="md-nav__link" for="nav-8-10">
      Optimization
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-10">
        Optimization
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/optimization/d2q9_adj/" title="D2q9 adj" class="md-nav__link">
      D2q9 adj
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/optimization/d2q9_optimalMixing/" title="d2q9 optimalMixing" class="md-nav__link">
      d2q9 optimalMixing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/optimization/d3q19_heat_adj/" title="D3q19 heat adj" class="md-nav__link">
      D3q19 heat adj
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-10-4" type="checkbox" id="nav-8-10-4">
    
    <label class="md-nav__link" for="nav-8-10-4">
      Experimental
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-10-4">
        Experimental
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/optimization/experimental/d2q9_heat_adj/" title="D2q9 heat adj" class="md-nav__link">
      D2q9 heat adj
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-11" type="checkbox" id="nav-8-11">
    
    <label class="md-nav__link" for="nav-8-11">
      Shallowwater
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-11">
        Shallowwater
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../models/shallowwater/sw/" title="Sw" class="md-nav__link">
      Sw
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-1" type="checkbox" id="nav-9-1" checked>
    
    <label class="md-nav__link" for="nav-9-1">
      Model development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-1">
        Model development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Finite difference wave equation
      </label>
    
    <a href="./" title="Finite difference wave equation" class="md-nav__link md-nav__link--active">
      Finite difference wave equation
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#finite-difference-wave-equation" title="Finite difference wave equation" class="md-nav__link">
    Finite difference wave equation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" title="Implementation" class="md-nav__link">
    Implementation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-model" title="Creating a model" class="md-nav__link">
    Creating a model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first-dynamics" title="First dynamics" class="md-nav__link">
    First dynamics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-quantities" title="Adding Quantities" class="md-nav__link">
    Adding Quantities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-a-case" title="Running a case" class="md-nav__link">
    Running a case
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#settings" title="Settings" class="md-nav__link">
    Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introducing-fd" title="Introducing FD" class="md-nav__link">
    Introducing FD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make-it-nicer" title="Make it nicer:" class="md-nav__link">
    Make it nicer:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-types" title="Node types" class="md-nav__link">
    Node types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2.-D2Q9-Single-Relexation-Time/" title="2. D2Q9 Single Relexation Time" class="md-nav__link">
      2. D2Q9 Single Relexation Time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3.-D2Q9-ShanChen-SRT/" title="3. D2Q9 ShanChen SRT" class="md-nav__link">
      3. D2Q9 ShanChen SRT
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">
    
    <label class="md-nav__link" for="nav-9-2">
      Particles
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-2">
        Particles
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../particles/particles-in-pipe/" title="Particles in pipe" class="md-nav__link">
      Particles in pipe
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#finite-difference-wave-equation" title="Finite difference wave equation" class="md-nav__link">
    Finite difference wave equation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" title="Implementation" class="md-nav__link">
    Implementation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-model" title="Creating a model" class="md-nav__link">
    Creating a model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first-dynamics" title="First dynamics" class="md-nav__link">
    First dynamics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-quantities" title="Adding Quantities" class="md-nav__link">
    Adding Quantities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-a-case" title="Running a case" class="md-nav__link">
    Running a case
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#settings" title="Settings" class="md-nav__link">
    Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introducing-fd" title="Introducing FD" class="md-nav__link">
    Introducing FD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make-it-nicer" title="Make it nicer:" class="md-nav__link">
    Make it nicer:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-types" title="Node types" class="md-nav__link">
    Node types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Finite difference wave equation</h1>
                
                <p>These tutorials will try to teach you how to make and use a new model in TCLB. First it will discuss our goal: the model we want to create. Then it will take you step by step, on how to create all the needed components.</p>
<h2 id="finite-difference-wave-equation">Finite difference wave equation</h2>
<p>We want to discretize the <a href="https://en.wikipedia.org/wiki/Wave_equation">Wave Equation</a>:</p>
<p>
<script type="math/tex; mode=display">\ddot{u} = c^2\Delta u</script>
</p>
<p>For this purpose we will use Finite Difference method. First we change the equation into two first order (in time) equations:</p>
<p>
<script type="math/tex; mode=display">\left\{\begin{eqnarray} \dot{v} =  &c^2\Delta u \\ \dot{u} =  &v  \end{eqnarray}\right.</script>
</p>
<p>Now let us discretise the <a href="https://en.wikipedia.org/wiki/Laplace_operator">Laplace operator</a> with simple finite difference (in 2D):</p>
<p>
<script type="math/tex; mode=display">\Delta u \approx \frac{(u_{i-1,j}+u_{i+1,j}+u_{i,j-1}+u_{i,j+1}-4u_{i,j})}{(dx^2)}</script>
</p>
<p>Finnaly we will use, what is called <a href="https://en.wikipedia.org/wiki/Semi-implicit_Euler_method">Semi-implicit Euler rule</a> to integrate this equation in time. This will give us:</p>
<p>
<script type="math/tex; mode=display">\left\{\begin{eqnarray} v^{n+1}_{i,j} &= v^n_{i,j}+dt c^2\Delta u^n \\ u^{n+1}_{i,j} &= u^n_{i,j} +dtv^{n+1}_{i,j} \end{eqnarray}\right.</script>
</p>
<p>The semi-implicit-ness can be seen in the index of <code>v</code> in the second line</p>
<p>Finnaly: we will get rid of all units by assuming <code>dx</code> and <code>dt</code> equal to 1</p>
<h2 id="implementation">Implementation</h2>
<h3 id="creating-a-model">Creating a model</h3>
<p>Every model in TCLB is defined by a subdirectory of <code>models</code>. Let us now create a new one:</p>
<div class="codehilite"><pre><span></span>mkdir models/tutorial/wave
touch models/tutorial/wave/conf.mk
</pre></div>


<p>The <code>conf.mk</code> file stores some additional settings for a model, but it also tells TCLB that this directory is in fact a model.</p>
<p>Now we have to add two main files defining everything: <code>Dynamics.R</code> - defining all the setup of the model, and <code>Dynamics.c</code> - defining what will be happening in a node.</p>
<div class="codehilite"><pre><span></span>touch models/tutorial/wave/Dynamics.R
touch models/tutorial/wave/Dynamics.c
</pre></div>


<p>We want to have two Fields: <code>u</code> and <code>v</code>. We define them in <code>Dynamics.R</code>:</p>
<div class="codehilite"><pre><span></span>AddField<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
AddField<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;v&quot;</span><span class="p">)</span>
</pre></div>


<p>Then we need the main dynamics of a node. First let us write down the functions that will be used in the model(in Dynamics.c):</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="n">float2</span> <span class="nf">Color</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">float2</span> <span class="n">ret</span><span class="p">;</span>
  <span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">ret</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Init</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

<span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Run</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</pre></div>


<p>The <code>CudaDeviceFunction</code> prefix is needed for all functions in <code>Dynamics.c</code> for technical reasons. We needed to fill only the <code>Color</code> function, as it is the only one which returns a value. For now, the model doesn't do much. Before continuing, let us first understand what these function do:</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Init</code></td>
<td>This function is called in all the nodes at the beginning of the simulation. All the initialization happens here.</td>
</tr>
<tr>
<td><code>Run</code></td>
<td>This function will be called in every node in every iteration - it is the main dynamic of a node.</td>
</tr>
<tr>
<td><code>Color</code></td>
<td>This function is useful only for the version of CLB with enabled graphics(<code>./configure --enable-graphics</code>). It calculates the level <code>x</code> on which the color of a pixel will be based. In most cases this will be temperature or velocity.</td>
</tr>
</tbody>
</table>
<h3 id="first-dynamics">First dynamics</h3>
<p>First, we want to initialize our fields(<code>Dynamics.c</code>):</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Init</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">u</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Then let us start with a model that just preserves both fields without changing them. In TCLB we access fields with a notation <code>u(dx,dy)</code>, where <code>dx</code> and <code>dy</code> is the position from which to take the field, relative to the current node(<code>Dynamics.c</code>):</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Run</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<h3 id="adding-quantities">Adding Quantities</h3>
<p>Finally we want to access the resulting data. In TCLB, the data that will be exported to VTK, TXT or other format, are called [[Quantities]]. Let us add a quantity <code>U</code> to <code>Dynamics.R</code>:</p>
<div class="codehilite"><pre><span></span>AddQuantity<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;U&quot;</span><span class="p">)</span>
</pre></div>


<p>Now we have to add the calculation(<code>Dynamics.c</code>):</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="n">real_t</span> <span class="nf">getU</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<h3 id="running-a-case">Running a case</h3>
<p>Now we need to create a case file (let's call it <code>example.xml</code>):</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;CLBConfig</span> <span class="na">output=</span><span class="s">&quot;output/&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Geometry</span> <span class="na">nx=</span><span class="s">&quot;128&quot;</span> <span class="na">ny=</span><span class="s">&quot;128&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/Geometry&gt;</span>
    <span class="nt">&lt;Model&gt;</span>
    <span class="nt">&lt;/Model&gt;</span>
    <span class="nt">&lt;VTK</span> <span class="na">Iterations=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Solve</span> <span class="na">Iterations=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/CLBConfig&gt;</span>
</pre></div>


<p>This case will create a mesh of 128x128 nodes, initialize it and run 1000 iterations. It will also save VTK output every 10 iterations.</p>
<p>In order to run it:</p>
<div class="codehilite"><pre><span></span>make configure
./configure --enable-graphics
make wave
CLB/wave/main example.xml
</pre></div>


<p>The results are not so impressive now, because basically, not only nothing is happening in a node, but also it is initialized with 0.</p>
<h3 id="settings">Settings</h3>
<p>Let us introduce two <a href="../Settings">settings</a> to our model(<code>Dynamics.R</code>):</p>
<div class="codehilite"><pre><span></span>AddSetting<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;Speed&quot;</span><span class="p">)</span>
AddSetting<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;Value&quot;</span><span class="p">,</span> zonal<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>


<p>Where <code>Speed</code> will be our parameter <code>k</code> in the wave equation, and <code>Value</code> will be the initial value of <code>u</code>. [[Settings]] which we want to be changing in the domain, are called "zonal". Settings are provided to us as variables in <code>Dynamics.c</code>. Additionally, we need to modify <code>Color</code> function to observe the change in values in preview window:</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="n">float2</span> <span class="nf">Color</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">float2</span> <span class="n">ret</span><span class="p">;</span>
  <span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">getU</span><span class="p">();</span>
  <span class="n">ret</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Init</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">u</span> <span class="o">=</span> <span class="n">Value</span><span class="p">;</span>
  <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Now we can name a region in our domain, and initialize it with a different value:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;CLBConfig</span> <span class="na">output=</span><span class="s">&quot;output/&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Geometry</span> <span class="na">nx=</span><span class="s">&quot;128&quot;</span> <span class="na">ny=</span><span class="s">&quot;128&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;None</span> <span class="na">name=</span><span class="s">&quot;box&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;Box</span> <span class="na">dx=</span><span class="s">&quot;60&quot;</span> <span class="na">nx=</span><span class="s">&quot;20&quot;</span> <span class="na">dy=</span><span class="s">&quot;20&quot;</span> <span class="na">ny=</span><span class="s">&quot;30&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/None&gt;</span>
    <span class="nt">&lt;/Geometry&gt;</span>
    <span class="nt">&lt;Model&gt;</span>
                <span class="nt">&lt;Params</span> <span class="na">Value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;Params</span> <span class="na">Value-box=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/Model&gt;</span>
    <span class="nt">&lt;VTK</span> <span class="na">Iterations=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Solve</span> <span class="na">Iterations=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/CLBConfig&gt;</span>
</pre></div>


<p>This will mark a box 20x30 starting from the point (60,20) as a zone called 'box'. Then in the <code>&lt;Model&gt;</code> we first set <code>Value</code> in all zones to <code>0</code>, then set it to <code>1</code> in 'box'. </p>
<p>Notice: Don't forget to compile(<code>make wave</code>) the model again before running it after making any changes to <code>Dynamics.c</code> or <code>Dynamics.R</code>.</p>
<p>You will see that the results now are much more interesting. Ok. I'm joking, they are sill constant - but at least not 0.</p>
<h3 id="introducing-fd">Introducing FD</h3>
<p>Now we want to introduce the discretisation of our wave equation in to the mix:</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Run</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">real_t</span> <span class="n">lap_u</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">real_t</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Speed</span> <span class="o">*</span> <span class="n">Speed</span> <span class="o">*</span> <span class="n">lap_u</span><span class="p">;</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>You can see that we assumed <code>dx</code> and <code>dt</code> equal to 1 (it will be more clear why, later on).</p>
<p>And now ... <strong>it won't compile</strong>. Why? The error is a bit obscure, like with many C++ Templates errors, but the reason is simple. We didn't tell the code that we want to access <code>u</code> in our neighbors. This is crucial, because the code have to know exactly were things are accessed, to prepare the right communication buffers. You can imagine that the neighboring node is on a different GPU on a different computer. Then we need this computer to know that it will have to send this data to us. On the other hand we want to send as small packets of information as possible, that is why the code have to be <em>conservative</em> wrt. to the possible access patterns. We define this information in <code>Dynamics.R</code>:</p>
<div class="codehilite"><pre><span></span>AddField<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">,</span> dx<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> dy<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>


<p>If you don't know <a href="https://www.r-project.org/">R</a> then you need to know that <code>c(...)</code> means a vector/table of numbers. The above line means that the field <code>u</code> can be accessed for <code>dx</code> from -1 to 1 and <code>dy</code> from -1 to 1. Making it simple: we can access it from all of our 8 neighbors and ourselves. The other way (a shortcut) to express it would be:</p>
<div class="codehilite"><pre><span></span>AddField<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">,</span> stencil2d<span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>


<p>Which means the same thing (<code>stencil3d</code> would mean also -1 to 1 in <code>z</code> direction)</p>
<p>Now, the code compiles. We can add another parameter</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Params</span> <span class="na">Speed=</span><span class="s">&quot;0.05&quot;</span> <span class="nt">/&gt;</span>
</pre></div>


<p>to our case file, run and see how the wave propagates.</p>
<h3 id="make-it-nicer">Make it nicer:</h3>
<p>We see that the result isn't very beautiful. It is partly because of our discretization, partly because the <a href="https://en.wikipedia.org/wiki/Sinc_function">Fourier transform of a rectangle</a> isn't very nice. Let us introduce viscosity/drag to the system:</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Run</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">real_t</span> <span class="n">lap_u</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">real_t</span> <span class="n">lap_v</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">real_t</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Speed</span> <span class="o">*</span> <span class="n">Speed</span> <span class="o">*</span> <span class="n">lap_u</span> <span class="o">+</span> <span class="n">Viscosity</span> <span class="o">*</span> <span class="n">lap_v</span><span class="p">;</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p><strong>Remember:</strong> you have to modify the <code>v</code> field access pattern, and add a <code>Viscosity</code> setting in <code>Dynamics.R</code>.</p>
<p>Now you can play a bit with the settings to see some nice waves propagating. It can be seen now more clearly that <strong>the domain in TCLB is always periodic</strong>. That is simply because it is the most general case. If you want to make your domain non-periodic - you must add boundary conditions - otherwise, whatever leaves on one side - comes back on the other.</p>
<h3 id="node-types">Node types</h3>
<p>Now we can add <a href="TODO:polinkować">node types</a> that will change the behavior of some, selected nodes. For instance, let us have a Dirichlet boundary condition. We want the nodes that are on the boundary to set <code>u</code> and <code>v</code> to a fixed value. Let's call such nodes <code>Dirichlet</code>. We define a new node type (yes, you guessed: in <code>Dynamics.R</code>):</p>
<div class="codehilite"><pre><span></span>AddNodeType<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;Dirichlet&quot;</span><span class="p">,</span> group<span class="o">=</span><span class="s">&quot;BOUNDARY&quot;</span><span class="p">)</span>
</pre></div>


<p>You can notice that node types have 'groups' (note: these groups, customary are with all caps). Each node can only be of one type ... from each group. You can imagine it like this: in each node we want to be able to set <em>separately</em> a boundary condition, choose a discretization model and add a heat source. But you cannot set <em>two</em> boundary conditions in the same node, from the same group.</p>
<p>Now, when we have this node type, we can use it to change the dynamics:</p>
<div class="codehilite"><pre><span></span><span class="n">CudaDeviceFunction</span> <span class="kt">void</span> <span class="nf">Run</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">real_t</span> <span class="n">lap_u</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">real_t</span> <span class="n">lap_v</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">real_t</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Speed</span> <span class="o">*</span> <span class="n">Speed</span> <span class="o">*</span> <span class="n">lap_u</span> <span class="o">+</span> <span class="n">Viscosity</span> <span class="o">*</span> <span class="n">lap_v</span><span class="p">;</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">NodeType</span> <span class="o">&amp;</span> <span class="n">NODE_BOUNDARY</span><span class="p">)</span> <span class="o">==</span> <span class="n">NODE_Dirichlet</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">Value</span><span class="p">;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>You can notice that we re-used the same zonal setting <code>Value</code> in this boundary condition. You can also notice, that the main calculation is still executed in the Dirichlet nodes. You can test it and see which version runs faster. Such additional computation can sometimes have a favorable impact on the performance on GPU, because of thing called <a href="http://stackoverflow.com/questions/17223640/is-branch-divergence-really-so-bad">branching</a>.</p>
<p>Now, we can set some Dirichlet elements in the case file:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;CLBConfig</span> <span class="na">output=</span><span class="s">&quot;output/&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Geometry</span> <span class="na">nx=</span><span class="s">&quot;128&quot;</span> <span class="na">ny=</span><span class="s">&quot;128&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Dirichlet</span> <span class="na">name=</span><span class="s">&quot;border&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;Box</span> <span class="na">nx=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;Box</span> <span class="na">dx=</span><span class="s">&quot;-1&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;Box</span> <span class="na">ny=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;Box</span> <span class="na">dy=</span><span class="s">&quot;-1&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/Dirichlet&gt;</span>
                <span class="nt">&lt;None</span> <span class="na">name=</span><span class="s">&quot;box&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;Box</span> <span class="na">dx=</span><span class="s">&quot;60&quot;</span> <span class="na">nx=</span><span class="s">&quot;20&quot;</span> <span class="na">dy=</span><span class="s">&quot;20&quot;</span> <span class="na">ny=</span><span class="s">&quot;30&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/None&gt;</span>
    <span class="nt">&lt;/Geometry&gt;</span>
    <span class="nt">&lt;Model&gt;</span>
                <span class="nt">&lt;Params</span> <span class="na">Value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;Params</span> <span class="na">Value-box=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;Params</span> <span class="na">Value-border=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;Params</span> <span class="na">Speed=</span><span class="s">&quot;0.05&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;Params</span> <span class="na">Viscosity=</span><span class="s">&quot;0.001&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/Model&gt;</span>
    <span class="nt">&lt;VTK</span> <span class="na">Iterations=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Solve</span> <span class="na">Iterations=</span><span class="s">&quot;10000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/CLBConfig&gt;</span>
</pre></div>


<p>We can notice the difference immediately. The waves are bouncing from the walls now.</p>
<p>In this case, we had a simple situation, as we have only one group of node types (and only one type), but normally we would have to distinguish between them. It would be done with:</p>
<div class="codehilite"><pre><span></span><span class="k">if</span> <span class="p">((</span><span class="n">NodeType</span> <span class="o">&amp;</span> <span class="n">NODE_BOUNDARY</span><span class="p">)</span> <span class="o">==</span> <span class="n">NODE_Dirichlet</span><span class="p">)</span> <span class="p">{</span>
 <span class="p">...</span>
<span class="p">}</span>
</pre></div>


<p>or</p>
<div class="codehilite"><pre><span></span><span class="k">switch</span> <span class="p">(</span><span class="n">NodeType</span> <span class="o">&amp;</span> <span class="n">NODE_BOUNDARY</span><span class="p">)</span> <span class="p">{</span>
<span class="k">case</span> <span class="nl">NODE_Dirichlet</span><span class="p">:</span>
 <span class="p">...</span>
 <span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="p">...</span><span class="o">:</span>
 <span class="p">...</span>
<span class="p">}</span>
</pre></div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../../models/shallowwater/sw/" title="Sw" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Sw
              </span>
            </div>
          </a>
        
        
          <a href="../2.-D2Q9-Single-Relexation-Time/" title="2. D2Q9 Single Relexation Time" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                2. D2Q9 Single Relexation Time
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
    
      
    
  </body>
</html>